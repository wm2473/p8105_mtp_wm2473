---
title: "p8105_mtp_wm2473"
output: github_document
date: "2022-10-21"
---
# Importing the library
```{r}
library(tidyverse)
library(readxl)
library(lubridate)
library(patchwork)
library(ggridges)
```

#Import, tidy, and otherwise clean the weight data, omitting notes entered as text.
```{r}
dog =   read_excel("dogweights_07may2022.xlsx") %>% 
 janitor::clean_names() %>%  
  setNames(c("Date", "Raisin","Simone","Gagne","std", "notes")) %>% 
    filter(Date != "DATE") %>% 
  select(-notes) %>% 
  pivot_longer(Raisin: Gagne, names_to = "type", values_to = "weight") %>%
  separate(weight, into = c("lbs", "oz"), sep = " ") %>%
  mutate(Date= as.Date('1899-12-30') + days(Date), weights_lbs = as.numeric(lbs) + as.numeric(oz)/16) %>% 
  na.omit()
  
```

# notes dataframe
```{r}
notes_df = 
  read_excel("dogweights_07may2022.xlsx") %>% 
   janitor::clean_names() %>%  
  setNames(c("Date", "Raisin","Simone","Gagne","std", "notes")) %>% 
    filter(Date != "DATE") %>%
  mutate(Date= as.Date('1899-12-30') + days(Date)) %>% 
  select(Date, notes) %>% 
  drop_na(notes)
```

#Export both dataframes as CSVs; store in the same directory as the raw data
```{r}
write.csv(dog,"./dog_weights_df.csv")
write.csv(notes_df,"./notes_df.csv")
```

#Briefly describe the resulting tidy dataset containing weights. How many unique dates are included in the dataset? Make a well-formatted table showing the number of observations for each dog, along with their average weight and the standard deviation
```{r}
dog %>%
  group_by(type, weights_lbs) %>%
  summarize(num_obs = n(),
            avg_weight = mean(weights_lbs, na.rm = TRUE),
            std_weight = sd(weights_lbs, na.rm = TRUE),
           .groups = 'drop') %>%
  knitr::kable(digits = 2)
```

# weights disturbution of each dog
```{r}
weightsplot = 
  dog %>%
  arrange(weights_lbs, type) %>% 
  ggplot(aes(x = type, y = weights_lbs, color = type)) +
  geom_boxplot() +
  labs(
    title = "Distribution plot",
    x = "Dog Types",
    y = "Weight(lbs)"
  )+ scale_y_continuous(breaks = c(8,10,12,14,16,18,20))+ scale_color_hue(name = "Name")

weightsplot
```

# dog's weight vs time
```{r}
wt = 
  dog %>%
  arrange(weights_lbs, Date) %>% 
  ggplot(aes(x = Date, y = weights_lbs, color = type)) + geom_point(alpha = .5,scale =3)+ labs(
    title = "Weight vs Time",
    x = "Date",
    y = "Weight(lbs)"
  ) +scale_x_continuous()
  theme(legend.position = "bottom")
wt
```

```{r}
weightsplot+wt
```

