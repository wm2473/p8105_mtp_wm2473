---
title: "p8105_mtp_wm2473"
output: github_document
date: "2022-10-21"
---
# Importing the library
```{r}
library(tidyverse)
library(readxl)
library(lubridate)
library(patchwork)
library(ggridges)
```
#Counting words
```{r}
wordcountaddin::text_stats("p8105_mtp_YOURUNI.Rmd")
```

#Problem 1
```{r}
# The raw data contain weights of three types of dogs. My goal is make the data more reasonable and readable for analysis by tidy and to clean the weight data and making some plots to see the realtionship of the weights and dog types. 

dog =   read_excel("./data/dogweights_07may2022.xlsx") %>% 
 janitor::clean_names() %>%  
  setNames(c("Date", "Raisin","Simone","Gagne","std", "notes")) %>% 
    filter(Date != "DATE") %>% 
  select(-notes) %>% 
  pivot_longer(Raisin: Gagne, names_to = "type", values_to = "weight") %>%
  separate(weight, into = c("lbs", "oz"), sep = " ") %>%
  mutate(Date= as.Date('1899-12-30') + days(Date), weights_lbs = as.numeric(lbs) + as.numeric(oz)/16) %>% 
  na.omit()
# After import data, I found that the columns name represents the dog types is messy. So I rename all the columns according to their original names. And I found that the weight column containing two units. I separate them into "lbs" and "oz", then combining them into the weights_lbs as total weight. The date column is the number from excel and I convert them into date based on the windows stating date. Finally I dropped NA value from the data set and remove the note column for the next question.  
```

# notes dataframe(second)
```{r}
notes_df = 
  read_excel("./data/dogweights_07may2022.xlsx") %>% 
   janitor::clean_names() %>%  
  setNames(c("Date", "Raisin","Simone","Gagne","std", "notes")) %>% 
    filter(Date != "DATE") %>%
  mutate(Date= as.Date('1899-12-30') + days(Date)) %>% 
  select(Date, notes) %>% 
  drop_na(notes)
```

#Export both dataframes as CSVs; store in the same dog directory as the raw data
```{r}
write.csv(dog,"./data/dog_weights_df.csv")
write.csv(notes_df,"./data/notes_df.csv")
```



#Briefly describe the resulting tidy dataset containing weights. How many unique dates are included in the dataset? Make a well-formatted table showing the number of observations for each dog, along with their average weight and the standard deviation
```{r}
dog %>%
  group_by(type, weights_lbs) %>%
  summarize(num_obs = n(),
            avg_weight = mean(weights_lbs, na.rm = TRUE),
            std_weight = sd(weights_lbs, na.rm = TRUE),
           .groups = 'drop') %>%
  knitr::kable(digits = 2)
```

# weights disturbution of each dog
```{r}
weightsplot = 
  dog %>%
  arrange(weights_lbs, type) %>% 
  ggplot(aes(x = type, y = weights_lbs, color = type)) +
  geom_boxplot() +
  labs(
    title = "Distribution plot",
    x = "Dog Types",
    y = "Weight(lbs)"
  )+ scale_y_continuous(breaks = c(8,10,12,14,16,18,20))+ scale_color_hue(name = "Name")

weightsplot
```

# dog's weight vs time
```{r}
wt = 
  dog %>%
  arrange(weights_lbs, Date) %>% 
  ggplot(aes(x = Date, y = weights_lbs, color = type)) + geom_point(alpha = .5,scale =3)+ labs(
    title = "Weight vs Time",
    x = "Date",
    y = "Weight(lbs)"
  ) +scale_x_continuous()
  theme(legend.position = "bottom")
wt
```

```{r}
weightsplot+wt
```

